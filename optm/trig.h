#define M_PI 3.141592653589793238462643383279502884197
#define LUTRES 800

double sin_lut[800] =  {0.000000000000, 0.001963494147, 0.003926980724, 0.005890452161, 0.007853900889, 0.009817319337, 0.011780699937, 0.013744035118, 0.015707317312, 0.017670538949, 0.019633692461, 0.021596770278, 0.023559764834, 0.025522668559, 0.027485473886, 0.029448173248, 0.031410759078, 0.033373223810, 0.035335559878, 0.037297759716, 0.039259815759, 0.041221720444, 0.043183466206, 0.045145045482, 0.047106450710, 0.049067674327, 0.051028708774, 0.052989546489, 0.054950179912, 0.056910601486, 0.058870803651, 0.060830778851, 0.062790519529, 0.064750018130, 0.066709267100, 0.068668258884, 0.070626985931, 0.072585440689, 0.074543615607, 0.076501503136, 0.078459095728, 0.080416385835, 0.082373365912, 0.084330028415, 0.086286365798, 0.088242370520, 0.090198035041, 0.092153351820, 0.094108313319, 0.096062912000, 0.098017140330, 0.099970990772, 0.101924455795, 0.103877527867, 0.105830199459, 0.107782463043, 0.109734311091, 0.111685736079, 0.113636730484, 0.115587286783, 0.117537397458, 0.119487054989, 0.121436251860, 0.123384980556, 0.125333233564, 0.127281003374, 0.129228282475, 0.131175063361, 0.133121338527, 0.135067100467, 0.137012341682, 0.138957054671, 0.140901231938, 0.142844865986, 0.144787949322, 0.146730474455, 0.148672433897, 0.150613820160, 0.152554625759, 0.154494843213, 0.156434465040, 0.158373483764, 0.160311891908, 0.162249682000, 0.164186846569, 0.166123378146, 0.168059269265, 0.169994512463, 0.171929100279, 0.173863025255, 0.175796279934, 0.177728856864, 0.179660748593, 0.181591947674, 0.183522446661, 0.185452238112, 0.187381314586, 0.189309668646, 0.191237292859, 0.193164179792, 0.195090322016, 0.197015712106, 0.198940342639, 0.200864206195, 0.202787295357, 0.204709602709, 0.206631120843, 0.208551842348, 0.210471759821, 0.212390865860, 0.214309153065, 0.216226614041, 0.218143241397, 0.220059027741, 0.221973965689, 0.223888047858, 0.225801266869, 0.227713615345, 0.229625085914, 0.231535671206, 0.233445363856, 0.235354156501, 0.237262041782, 0.239169012343, 0.241075060833, 0.242980179903, 0.244884362209, 0.246787600409, 0.248689887165, 0.250591215144, 0.252491577015, 0.254390965452, 0.256289373133, 0.258186792738, 0.260083216952, 0.261978638463, 0.263873049965, 0.265766444154, 0.267658813730, 0.269550151398, 0.271440449865, 0.273329701845, 0.275217900052, 0.277105037209, 0.278991106039, 0.280876099271, 0.282760009638, 0.284642829877, 0.286524552728, 0.288405170937, 0.290284677254, 0.292163064433, 0.294040325232, 0.295916452414, 0.297791438745, 0.299665276996, 0.301537959944, 0.303409480370, 0.305279831056, 0.307149004793, 0.309016994375, 0.310883792599, 0.312749392270, 0.314613786193, 0.316476967182, 0.318338928053, 0.320199661627, 0.322059160732, 0.323917418198, 0.325774426861, 0.327630179562, 0.329484669145, 0.331337888463, 0.333189830368, 0.335040487723, 0.336889853392, 0.338737920245, 0.340584681158, 0.342430129009, 0.344274256686, 0.346117057077, 0.347958523079, 0.349798647592, 0.351637423522, 0.353474843779, 0.355310901280, 0.357145588947, 0.358978899705, 0.360810826488, 0.362641362231, 0.364470499879, 0.366298232379, 0.368124552685, 0.369949453755, 0.371772928554, 0.373594970053, 0.375415571225, 0.377234725054, 0.379052424524, 0.380868662628, 0.382683432365, 0.384496726737, 0.386308538754, 0.388118861431, 0.389927687788, 0.391735010852, 0.393540823655, 0.395345119234, 0.397147890635, 0.398949130906, 0.400748833103, 0.402546990288, 0.404343595529, 0.406138641898, 0.407932122476, 0.409724030348, 0.411514358605, 0.413303100346, 0.415090248674, 0.416875796699, 0.418659737537, 0.420442064312, 0.422222770150, 0.424001848187, 0.425779291565, 0.427555093430, 0.429329246937, 0.431101745245, 0.432872581520, 0.434641748937, 0.436409240673, 0.438175049916, 0.439939169856, 0.441701593693, 0.443462314632, 0.445221325885, 0.446978620671, 0.448734192214, 0.450488033747, 0.452240138507, 0.453990499740, 0.455739110697, 0.457485964637, 0.459231054826, 0.460974374535, 0.462715917044, 0.464455675639, 0.466193643611, 0.467929814261, 0.469664180894, 0.471396736826, 0.473127475376, 0.474856389871, 0.476583473646, 0.478308720042, 0.480032122409, 0.481753674102, 0.483473368483, 0.485191198924, 0.486907158800, 0.488621241497, 0.490333440406, 0.492043748926, 0.493752160464, 0.495458668432, 0.497163266253, 0.498865947353, 0.500566705169, 0.502265533143, 0.503962424727, 0.505657373378, 0.507350372561, 0.509041415750, 0.510730496425, 0.512417608074, 0.514102744193, 0.515785898285, 0.517467063861, 0.519146234439, 0.520823403546, 0.522498564716, 0.524171711490, 0.525842837419, 0.527511936058, 0.529179000974, 0.530844025740, 0.532507003935, 0.534167929149, 0.535826794979, 0.537483595029, 0.539138322911, 0.540790972246, 0.542441536663, 0.544090009798, 0.545736385296, 0.547380656809, 0.549022817998, 0.550662862533, 0.552300784090, 0.553936576354, 0.555570233020, 0.557201747788, 0.558831114369, 0.560458326482, 0.562083377852, 0.563706262215, 0.565326973314, 0.566945504900, 0.568561850734, 0.570176004584, 0.571787960228, 0.573397711449, 0.575005252043, 0.576610575812, 0.578213676567, 0.579814548127, 0.581413184320, 0.583009578983, 0.584603725962, 0.586195619111, 0.587785252292, 0.589372619378, 0.590957714247, 0.592540530789, 0.594121062902, 0.595699304492, 0.597275249476, 0.598848891776, 0.600420225326, 0.601989244068, 0.603555941954, 0.605120312942, 0.606682351002, 0.608242050112, 0.609799404258, 0.611354407437, 0.612907053653, 0.614457336921, 0.616005251263, 0.617550790712, 0.619093949310, 0.620634721107, 0.622173100162, 0.623709080546, 0.625242656336, 0.626773821619, 0.628302570494, 0.629828897065, 0.631352795449, 0.632874259771, 0.634393284164, 0.635909862772, 0.637423989749, 0.638935659256, 0.640444865467, 0.641951602563, 0.643455864734, 0.644957646181, 0.646456941115, 0.647953743755, 0.649448048330, 0.650939849080, 0.652429140253, 0.653915916108, 0.655400170912, 0.656881898943, 0.658361094489, 0.659837751847, 0.661311865324, 0.662783429236, 0.664252437911, 0.665718885685, 0.667182766905, 0.668644075926, 0.670102807114, 0.671558954847, 0.673012513510, 0.674463477499, 0.675911841220, 0.677357599089, 0.678800745533, 0.680241274987, 0.681679181899, 0.683114460724, 0.684547105929, 0.685977111990, 0.687404473395, 0.688829184641, 0.690251240234, 0.691670634693, 0.693087362546, 0.694501418329, 0.695912796592, 0.697321491894, 0.698727498803, 0.700130811899, 0.701531425771, 0.702929335020, 0.704324534257, 0.705717018102, 0.707106781187, 0.708493818154, 0.709878123655, 0.711259692355, 0.712638518925, 0.714014598051, 0.715387924428, 0.716758492760, 0.718126297763, 0.719491334165, 0.720853596703, 0.722213080124, 0.723569779188, 0.724923688665, 0.726274803333, 0.727623117985, 0.728968627421, 0.730311326456, 0.731651209912, 0.732988272623, 0.734322509436, 0.735653915205, 0.736982484798, 0.738308213093, 0.739631094979, 0.740951125355, 0.742268299133, 0.743582611234, 0.744894056592, 0.746202630149, 0.747508326863, 0.748811141697, 0.750111069630, 0.751408105651, 0.752702244758, 0.753993481962, 0.755281812285, 0.756567230761, 0.757849732433, 0.759129312357, 0.760405965600, 0.761679687240, 0.762950472367, 0.764218316080, 0.765483213493, 0.766745159729, 0.768004149921, 0.769260179218, 0.770513242776, 0.771763335764, 0.773010453363, 0.774254590764, 0.775495743172, 0.776733905801, 0.777969073878, 0.779201242641, 0.780430407338, 0.781656563233, 0.782879705596, 0.784099829714, 0.785316930881, 0.786531004405, 0.787742045607, 0.788950049816, 0.790155012376, 0.791356928641, 0.792555793977, 0.793751603763, 0.794944353388, 0.796134038253, 0.797320653773, 0.798504195372, 0.799684658487, 0.800862038568, 0.802036331075, 0.803207531481, 0.804375635270, 0.805540637940, 0.806702534998, 0.807861321966, 0.809016994375, 0.810169547771, 0.811318977709, 0.812465279759, 0.813608449501, 0.814748482527, 0.815885374444, 0.817019120867, 0.818149717425, 0.819277159760, 0.820401443526, 0.821522564386, 0.822640518021, 0.823755300119, 0.824866906382, 0.825975332525, 0.827080574275, 0.828182627370, 0.829281487562, 0.830377150614, 0.831469612303, 0.832558868415, 0.833644914753, 0.834727747129, 0.835807361368, 0.836883753308, 0.837956918800, 0.839026853705, 0.840093553899, 0.841157015269, 0.842217233716, 0.843274205152, 0.844327925502, 0.845378390703, 0.846425596707, 0.847469539474, 0.848510214982, 0.849547619216, 0.850581748179, 0.851612597883, 0.852640164354, 0.853664443630, 0.854685431763, 0.855703124816, 0.856717518865, 0.857728610000, 0.858736394323, 0.859740867949, 0.860742027004, 0.861739867629, 0.862734385978, 0.863725578215, 0.864713440520, 0.865697969084, 0.866679160112, 0.867657009820, 0.868631514438, 0.869602670210, 0.870570473392, 0.871534920253, 0.872496007073, 0.873453730148, 0.874408085786, 0.875359070306, 0.876306680044, 0.877250911345, 0.878191760569, 0.879129224089, 0.880063298291, 0.880993979574, 0.881921264348, 0.882845149041, 0.883765630089, 0.884682703944, 0.885596367070, 0.886506615945, 0.887413447059, 0.888316856917, 0.889216842036, 0.890113398945, 0.891006524188, 0.891896214323, 0.892782465918, 0.893665275558, 0.894544639838, 0.895420555369, 0.896293018773, 0.897162026687, 0.898027575761, 0.898889662657, 0.899748284052, 0.900603436636, 0.901455117112, 0.902303322197, 0.903148048619, 0.903989293123, 0.904827052466, 0.905661323417, 0.906492102760, 0.907319387293, 0.908143173825, 0.908963459181, 0.909780240199, 0.910593513729, 0.911403276635, 0.912209525797, 0.913012258106, 0.913811470467, 0.914607159799, 0.915399323033, 0.916187957117, 0.916973059010, 0.917754625684, 0.918532654127, 0.919307141339, 0.920078084335, 0.920845480141, 0.921609325800, 0.922369618366, 0.923126354909, 0.923879532511, 0.924629148268, 0.925375199291, 0.926117682702, 0.926856595640, 0.927591935256, 0.928323698714, 0.929051883194, 0.929776485888, 0.930497504003, 0.931214934759, 0.931928775390, 0.932639023143, 0.933345675281, 0.934048729080, 0.934748181828, 0.935444030830, 0.936136273402, 0.936824906876, 0.937509928596, 0.938191335922, 0.938869126228, 0.939543296898, 0.940213845336, 0.940880768954, 0.941544065183, 0.942203731465, 0.942859765256, 0.943512164028, 0.944160925265, 0.944806046467, 0.945447525145, 0.946085358828, 0.946719545055, 0.947350081382, 0.947976965378, 0.948600194626, 0.949219766723, 0.949835679281, 0.950447929925, 0.951056516295, 0.951661436045, 0.952262686841, 0.952860266367, 0.953454172319, 0.954044402406, 0.954630954354, 0.955213825900, 0.955793014798, 0.956368518815, 0.956940335732, 0.957508463345, 0.958072899462, 0.958633641909, 0.959190688523, 0.959744037157, 0.960293685677, 0.960839631964, 0.961381873914, 0.961920409436, 0.962455236454, 0.962986352905, 0.963513756743, 0.964037445933, 0.964557418458, 0.965073672312, 0.965586205504, 0.966095016060, 0.966600102017, 0.967101461428, 0.967599092360, 0.968092992895, 0.968583161129, 0.969069595171, 0.969552293146, 0.970031253195, 0.970506473469, 0.970977952136, 0.971445687380, 0.971909677397, 0.972369920398, 0.972826414608, 0.973279158268, 0.973728149632, 0.974173386970, 0.974614868564, 0.975052592713, 0.975486557729, 0.975916761939, 0.976343203684, 0.976765881321, 0.977184793219, 0.977599937765, 0.978011313356, 0.978418918408, 0.978822751349, 0.979222810622, 0.979619094684, 0.980011602008, 0.980400331081, 0.980785280403, 0.981166448492, 0.981543833876, 0.981917435102, 0.982287250729, 0.982653279331, 0.983015519497, 0.983373969830, 0.983728628950, 0.984079495487, 0.984426568090, 0.984769845420, 0.985109326155, 0.985445008984, 0.985776892615, 0.986104975768, 0.986429257176, 0.986749735592, 0.987066409778, 0.987379278515, 0.987688340595, 0.987993594828, 0.988295040036, 0.988592675057, 0.988886498745, 0.989176509965, 0.989462707600, 0.989745090547, 0.990023657717, 0.990298408035, 0.990569340444, 0.990836453897, 0.991099747366, 0.991359219835, 0.991614870304, 0.991866697788, 0.992114701314, 0.992358879929, 0.992599232689, 0.992835758668, 0.993068456955, 0.993297326652, 0.993522366877, 0.993743576762, 0.993960955455, 0.994174502117, 0.994384215926, 0.994590096072, 0.994792141762, 0.994990352217, 0.995184726672, 0.995375264379, 0.995561964603, 0.995744826624, 0.995923849737, 0.996099033252, 0.996270376493, 0.996437878800, 0.996601539527, 0.996761358044, 0.996917333733, 0.997069465994, 0.997217754240, 0.997362197900, 0.997502796416, 0.997639549247, 0.997772455865, 0.997901515758, 0.998026728428, 0.998148093393, 0.998265610185, 0.998379278350, 0.998489097451, 0.998595067063, 0.998697186779, 0.998795456205, 0.998889874962, 0.998980442686, 0.999067159027, 0.999150023652, 0.999229036241, 0.999304196489, 0.999375504107, 0.999442958819, 0.999506560366, 0.999566308502, 0.999622202997, 0.999674243636, 0.999722430218, 0.999766762557, 0.999807240482, 0.999843863837, 0.999876632482, 0.999905546289, 0.999930605147, 0.999951808959, 0.999969157645, 0.999982651136, 0.999992289381, 0.999998072344};

double lsin(double x) {
	while (x<0) {
		x+=2*M_PI;
	}
	while (x>(2*M_PI)) {
		x-=2*M_PI;
	}

	if (x<=(M_PI/2) & x>=0) {
		int index = x*(LUTRES/(M_PI/2));
		return sin_lut[index];
	}
	if (x<=M_PI & x>(M_PI/2)) {
		int index = (M_PI-x)*(LUTRES/(M_PI/2));
		return sin_lut[index];
	}
	if (x<=((3*M_PI)/2) & x>M_PI) {
		int index = (x-M_PI)*(LUTRES/(M_PI/2));
		return -sin_lut[index];
	}
	if (x<=(M_PI*2) & x>((3*M_PI)/2)) {
		int index = ((M_PI/2)-(x-((3*M_PI)/2)))*(LUTRES/(M_PI/2));
		return -sin_lut[index];
	}
}

double lcos(double x) {
	return lsin((M_PI/2)-x);
}

